
from mongomodel.crawl.twitter.models import *

import pymongo


user_ids = [112724745, 66958905, 85558811, 21880585, 82026749, 22798391, 18755371, 29181568, 1101741, 140475840, 17023494, 50838486, 32399360, 120392432, 16070608, 14519349, 15651494, 158696981, 183267802, 6974162, 156542043, 28254549, 26906684, 14510781, 259935923, 19460093, 7451022, 45339620, 80816333, 19686020, 133022087, 114845306, 191543365, 74078447, 16570722, 28056319, 22926660, 184095411, 44798253, 26437097, 53728344, 110593918, 231927744, 170677411, 128098218, 33845682, 48057990, 137902468, 17513474, 7582832, 16478966, 16567643, 264229360, 42363561, 172608608, 5547022, 207948843, 1095511, 49595173, 14137027, 70116209, 16486812, 17546014, 443902440, 72631850, 223527835, 17458866, 15423556, 16818221, 76963615, 248212400, 6166042, 42180543, 311845225, 79129072, 21424233, 54575173, 54946864, 17260140, 118083728, 25754814, 15045218, 20529038, 43837335, 8893282, 73100625, 37222477, 112231906, 280035308, 12970412, 18695966, 248171477, 107512786, 66904150] 

def export(filename):
    db = init()
    users = User.objects.filter(uid__in = user_ids)
    tweets = Tweet.objects.filter(user__in = users)
    f_out = open(filename,'w')
    for t in tweets:
        ln = "\t".join([str(t.user.uid),t.user.screen_name.encode('utf-8'),t.text.encode('utf-8').replace('\r',' ').replace('\n',' '), str(t.created_at)])
        print >> f_out, ln
            

    if pymongo.version == '2.0.1':
        db.connection.disconnect()
    else:
        db.disconnect()

    
    
    
